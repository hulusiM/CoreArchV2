<script>$('#broadCrumbDiv').text('Yönetici Raporları / Genel Araç Raporu')</script>
<script src="~/admin/amcharts4/core.js"></script>
<script src="~/admin/amcharts4/charts.js"></script>
<script src="~/admin/amcharts4/themes/animated.js"></script>
<script src="~/admin/amcharts4/themes/kelly.js"></script>

<!-- Header Dashboard -->
<div class="row" style="margin: 3px -20px 0 -29px;">
    <div class="col-sm-6 col-md-3">
        <div class="panel panel-body bg-blue-400 has-bg-image">
            <div class="media no-margin">
                <div class="media-body">
                    <h3 class="no-margin" id="fixVehicleDiv">---</h3>
                    <span class="text-uppercase text-size-mini">Mülkiyet Araç</span>
                </div>

                <div class="media-right media-middle">
                    <i class="icon-car icon-3x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-md-3">
        <div class="panel panel-body bg-success-400 has-bg-image">
            <div class="media no-margin">
                <div class="media-body">
                    <h3 class="no-margin" id="rentVehicleDiv">---</h3>
                    <span class="text-uppercase text-size-mini">Kiralık Araç</span>
                </div>

                <div class="media-right media-middle">
                    <i class="icon-weather-windy icon-3x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-md-3">
        <div class="panel panel-body bg-orange-400 has-bg-image">
            <div class="media no-margin">
                <div class="media-body">
                    <h3 class="no-margin" id="emptyVehicleDiv">---</h3>
                    <span class="text-uppercase text-size-mini">Servisteki Araç</span>
                </div>

                <div class="media-right media-middle">
                    <i class="icon-car2 icon-3x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-md-3">
        <div class="panel panel-body bg-danger-300 has-bg-image">
            <div class="media no-margin">
                <div class="media-body">
                    <h3 class="no-margin" id="allVehicleDiv">---</h3>
                    <span class="text-uppercase text-size-mini">Toplam Araç</span>
                </div>

                <div class="media-right media-middle">
                    <i class="icon-cabinet icon-3x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Header Dashboard -->

<div class="breadcrumb-line breadcrumb-line-component bg-teal-400" style="margin: 0px -11px 0px -19px; color: #fff;">
    <ul class="breadcrumb">
        <li>Genel Araç Raporu</li>
    </ul>
    <ul class="breadcrumb-elements">
        <li class="dropdown">
            <a href="#" id="btnSearch" class="dropdown-toggle" data-toggle="dropdown" onclick="funcSearchForm()">
                <i class="icon-gear position-left"></i>
                Filtreleme Seçenekleri
                <span class="caret"></span>
            </a>
            <ul id="FormSearchTable" class="dropdown-menu dropdown-menu-right" style="width: 326px;">
                <li>
                    <div class="col-md-12" style="margin-top: 8px;">
                        <select id="mainPageParentUnitIdVec"
                                tabindex="1"
                                table-param="ParentUnitId"
                                onchange="changeParentUnitId(true)"
                                class="select-search"
                                table-id="comboBox-mainPageParentUnitIdVec"
                                table-model-url="/Combo/GetUnitJustParentCmbx"
                                table-tool-type="comboBox"
                                data-option-label="Müdürlük Seçiniz">
                        </select>
                    </div>
                </li>
                <li>
                    <div class="col-md-12" style="margin-top: 8px;">
                        <select id="mainPageUnitIdVec"
                                tabindex="2"
                                table-param="UnitId"
                                @*onchange="onchangeUnitId()"*@
                                class="select-search"
                                table-id="comboBox-mainPageUnitIdVec"
                                table-model-url=""
                                table-tool-type="comboBox"
                                data-option-label="Proje Seçiniz">
                        </select>
                    </div>
                </li>
                <li>
                    <div class="col-md-12" style="margin-top: 8px;">
                        <button type="button" style="width: 100%;" class="btn bg-danger-800 btn-xs" onclick="funcClearFilterTable('FormSearchTable')"><i class="icon-trash"></i> Temizle</button>
                    </div>
                </li>
                <li>
                    <div class="col-md-12" style="margin: 8px 0 8px 0;">
                        <button type="button" style="float: left; width: 100%;" class="btn bg-teal-300 btn-xs" onclick="funcFilterTable()"><i class="icon-search4"></i> Filtrele</button>
                    </div>
                </li>
            </ul>
        </li>
    </ul>
</div>

<!-- Content Dashboard-->
<div class="row" style="margin: 0px -20px 0 -29px;">
    <div class="col-md-6">
        <div class="table-responsive" style="margin-top: 5px;">
            <div class="panel panel-flat">
                <div id="chart3" style="height: 450px; width: 100%;"></div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="table-responsive" style="margin-top: 5px;">
            <div class="panel panel-flat">
                <div id="chart1" style="height: 450px; width: 100%;"></div>
            </div>
        </div>
    </div>
</div>
<div class="row" style="margin: 0px -20px 0 -29px;">
    <div class="col-md-6">
        <div class="table-responsive" style="margin-top: 5px;">
            <div class="panel panel-flat">
                <div id="chart2" style="height: 450px; width: 100%;"></div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="table-responsive" style="margin-top: 5px;">
            <div class="panel panel-flat">
                <div id="chart4" style="height: 450px; width: 100%;"></div>
            </div>
        </div>
    </div>
</div>
<div class="row" style="margin: 0px -20px 0 -29px;">
    <div class="col-md-6">
        <div class="table-responsive" style="margin-top: 5px;">
            <div class="panel panel-flat">
                <div id="chart6" style="height: 450px; width: 100%;"></div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="table-responsive" style="margin-top: 5px;">
            <div class="panel panel-flat">
                <div id="chart5" style="height: 450px; width: 100%;"></div>
            </div>
        </div>
    </div>
</div>
<!-- Content Dashboard-->


<script src="~/js/jsamchart/vehicle.js"></script>
<script src="~/js/jsamchart/chartutility.js"></script>
<script>
    $(document).ready(function () {
        $(".sidebar-control").click();
        loadChartVehicle({});
    });

    //Müdürlük filtresi
    function changeParentUnitId(isFilter = false) {
        var parentUnitId = $('#mainPageParentUnitIdVec').val();
        var model = {
            ParentUnitId: parentUnitId
        };
        loadUnit(parentUnitId);
        if (!isFilter)
            loadCharts(model);
    }

    function loadUnit(parentUnitId) {
        sendAjxForm({ parentId: parentUnitId },
            "/Combo/GetUnitChildCmbx",
            function (e) {
                funcCustomComboBox(e, "mainPageUnitIdVec", "Proje Seçiniz");
            }, "GET");
    }

    function loadChartVehicle(model) {
        activeVehicle(model);
        rentVehicleFirmCount(model);
        managementVehicleCount(model);
        usageTypeVehicleCount(model);
        modelYearVehicle(model);
        modelYearPercentVehicle(model);
    }

    //Araç model yıl
    function modelYearVehicle(model) {
        sendAjxForm(model,
            "/Report/ModelYearVehicleCount",
            function (data) {
                chart5(data);
            }, "GET");
    }
      //Araç model yıl yüzdelik
    function modelYearPercentVehicle(model) {
        sendAjxForm(model,
            "/Report/ModelYearPercentVehicleCount",
            function (data) {
                chart6(data);
            }, "GET");
    }

    //Araç sayıları
    function activeVehicle(model) {
        sendAjxForm(model,
            "/Home/ActiveVehicleCount",
            function (data) {
                $('#allVehicleDiv').text(data.AllVehicle);
                //$('#emptyVehicleDiv').text(data.InPoolVehicle.length);
                $('#emptyVehicleDiv').text(data.ServiceInVehicle.length);
                $('#rentVehicleDiv').text(data.RentVehicle.length);
                $('#fixVehicleDiv').text(data.FixVehicle.length);
                chart1(data);
            }, "GET");
    }

    //Kiralık araç firma ve araç sayıları
    function rentVehicleFirmCount(model) {
        sendAjxForm(model,
            "/Report/RentVehicleFirmCount",
            function (data) {
                chart2(data);
            }, "GET");
    }

    //Müdürlük bazında araç sayısı
    function managementVehicleCount(model) {
        sendAjxForm(model,
            "/Report/ManagementVehicleCount",
            function (data) {
                chart3(data);
            }, "GET");
    }

    //Kullanım tipine göre araç sayısı
    function usageTypeVehicleCount(model) {
        sendAjxForm(model,
            "/Report/UsageTypeVehicleCount",
            function (data) {
                chart4(data);
            }, "GET");
    }

    //------------------------------------- Static Area Start ---------------------------------------//
    function funcFilterTable(incomingUrl) {
        var model = FormGetAllValue("#FormSearchTable [table-param]");
        loadChartVehicle(model);

        IsSearchOpen = false;
        $('#FormSearchTable').hide();
    }

    function funcClearFilterTable() {
        loadChartVehicle({});
        FormAllInputsClear('#FormSearchTable [table-param]');
        ShowMessage("success", "Bilgi", "Tüm parametreler temizlendi.");
    }
    //------------------------------------- Static Area End ---------------------------------------//
</script>